<!DOCTYPE html>
<html>
<body>
  <h2>S3 Presigned POST Test</h2>
  <button onclick="upload()">Upload JSON</button>
  <pre id="log"></pre>

  <script>
    async function upload() {
      const log = document.getElementById("log");
      log.textContent = "Uploading...\n";

      // üëá Replace with your actual values (these are placeholders)
      const url = "https://s3.us-east-1.amazonaws.com/jaetill-game-nights";
      const fields = {
        "Content-Type": "application/json",
        "bucket": "jaetill-game-nights",
        "X-Amz-Algorithm": "AWS4-HMAC-SHA256",
        "X-Amz-Credential": "AKIATD5ZASBEN3WXOFMW/20250619/us-east-1/s3/aws4_request",
        "X-Amz-Date": "20250619T045845Z",
        "key": "gameNights.json",
        "Policy": 'eyJleHBpcmF0aW9uIjoiMjAyNS0wNi0xOVQwNDo1OTozNVoiLCJjb25kaXRpb25zIjpbWyJzdGFydHMtd2l0aCIsIiRDb250ZW50LVR5cGUiLCJhcHBsaWNhdGlvbi9qc29uIl0seyJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi9qc29uIn0seyJidWNrZXQiOiJqYWV0aWxsLWdhbWUtbmlnaHRzIn0seyJYLUFtei1BbGdvcml0aG0iOiJBV1M0LUhNQUMtU0hBMjU2In0seyJYLUFtei1DcmVkZW50aWFsIjoiQUtJQVRENVpBU0JFTjNXWE9GTVcvMjAyNTA2MTkvdXMtZWFzdC0xL3MzL2F3czRfcmVxdWVzdCJ9LHsiWC1BbXotRGF0ZSI6IjIwMjUwNjE5VDA0NTQzNVoifSx7ImtleSI6ImdhbWVOaWdodHMuanNvbiJ9XX0=',
        "X-Amz-Signature": "5c94ff...snip..."
      };

      const formData = new FormData();
      for (const name in fields) {
        formData.append(name, fields[name]);
      }

      const blob = new Blob(
        [JSON.stringify({ from: "presigned POST", success: true }, null, 2)],
        { type: "application/json" }
      );
      formData.append("file", blob); // this must be named 'file'

      try {
        const res = await fetch(url, {
          method: "POST",
          body: formData
        });

        if (res.ok) {
          log.textContent += "‚úÖ Upload succeeded!";
        } else {
          log.textContent += `‚ùå Upload failed: ${res.status}`;
        }
      } catch (e) {
        log.textContent += `‚ùå Error: ${e.message}`;
      }
    }
  </script>
</body>
</html>
